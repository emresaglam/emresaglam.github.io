<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-11-08T15:21:03-08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">eBlog</title><subtitle>Emre's blog!</subtitle><author><name>Emre Saƒülam</name></author><entry><title type="html">Apple watch radio</title><link href="http://localhost:4000/general/apple-watch-radio/" rel="alternate" type="text/html" title="Apple watch radio" /><published>2020-05-01T20:16:36-07:00</published><updated>2020-05-01T20:16:36-07:00</updated><id>http://localhost:4000/general/apple-watch-radio</id><content type="html" xml:base="http://localhost:4000/general/apple-watch-radio/">&lt;p&gt;If you‚Äôre like me and you have the radio app not working and your Apple Watch is saying: ‚ÄúSign in to your Apple ID in General in the Apple Watch app on your iPhone‚Äù (And of course you are signed in), this solved my issue.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Go to ‚ÄúSettings -&amp;gt; iTunes &amp;amp; App Store‚Äù&lt;/li&gt;
  &lt;li&gt;Tap on your logged in Apple ID.&lt;/li&gt;
  &lt;li&gt;Tap Sign Out button.&lt;/li&gt;
  &lt;li&gt;Reboot your phone (Just in case!)&lt;/li&gt;
  &lt;li&gt;Go back to ‚ÄúSettings -&amp;gt; iTunes &amp;amp; App Store‚Äù&lt;/li&gt;
  &lt;li&gt;Log back in with your Apple ID&lt;/li&gt;
  &lt;li&gt;Go to you Apple Watch and most probably you‚Äôll see Radio working! Hurray!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Apple Watch Series 4 just in case. ;)&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="apple" /><category term="apple watch" /><category term="tips" /><category term="watch" /><summary type="html">If you‚Äôre like me and you have the radio app not working and your Apple Watch is saying: ‚ÄúSign in to your Apple ID in General in the Apple Watch app on your iPhone‚Äù (And of course you are signed in), this solved my issue.</summary></entry><entry><title type="html">So you lost a disk on a MD RAID5 array, now¬†what?</title><link href="http://localhost:4000/general/so-you-lost-a-disk-on-a-md-raid5-array-now-what/" rel="alternate" type="text/html" title="So you lost a disk on a MD RAID5 array, now¬†what?" /><published>2020-04-28T16:47:21-07:00</published><updated>2020-04-28T16:47:21-07:00</updated><id>http://localhost:4000/general/so-you-lost-a-disk-on-a-md-raid5-array-now-what</id><content type="html" xml:base="http://localhost:4000/general/so-you-lost-a-disk-on-a-md-raid5-array-now-what/">&lt;p&gt;It happens, you just lost a disk on your RAID5 MD array, or things are not how it should look like‚Ä¶ How do we troubleshoot this?&lt;/p&gt;

&lt;p&gt;First things first, what‚Äôs the name of your MD device. You can easily learn that by issuing:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /proc/mdstat
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should output something similar to:&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;go&quot;&gt;Personalities : [linear] [multipath] [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdd[1] sda[3] sdb[2]
2929890816 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/4] [.AAA]
bitmap: 0/8 pages [0KB], 65536KB chunk
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here we have a MD device &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/md0&lt;/code&gt;. (If you don‚Äôt see a response to this, you might have lost your MD device, which could be a bigger issue!)&lt;/p&gt;

&lt;p&gt;Another thing that we see (Or we don‚Äôt see) here is that sda/sdb/sdd are here in the raid but &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sdc&lt;/code&gt; is nowhere to be found! This is our problem.&lt;/p&gt;

&lt;p&gt;For some reason &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/sdc&lt;/code&gt; is not in the RAID group anymore. Let‚Äôs see what‚Äôs going on with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/sdc&lt;/code&gt;?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mdadm &lt;span class=&quot;nt&quot;&gt;--examine&lt;/span&gt; /dev/sdc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my example this was hanging for a long time. When I issue &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dmesg&lt;/code&gt; on another console, I was getting a lot of I/O errors about this disk. This is telling me that the disk is malfunctioning.&lt;/p&gt;

&lt;p&gt;I shutdown the server and wiggled the disk. Rebooted and it was back online. My array has now four disks however only 3 of them are ‚Äúfunctioning‚Äù since after the reboot MD kicked &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/sdc&lt;/code&gt; out of the array.&lt;/p&gt;

&lt;p&gt;We need to reassemble the array and let RAID5 do its magic. First stop the MD device &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/md0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mdadm &lt;span class=&quot;nt&quot;&gt;--stop&lt;/span&gt; /dev/md0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we need to add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/sdc&lt;/code&gt; back into the array:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mdadm /dev/md0 &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; /dev/sdc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then depending on the situation we might need to reassemble the array:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mdadm &lt;span class=&quot;nt&quot;&gt;--assemble&lt;/span&gt; /dev/md0 /dev/sd[abcd] &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hopefully &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/sdc&lt;/code&gt; is now back in your array now. This should start a long(er) process to sync up the array state to all disks and hopefully you now have your array back!&lt;/p&gt;

&lt;p&gt;After the sync completes, I would still do a fsck on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/md0&lt;/code&gt; filesystem.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fsck.ext4 /dev/md0
e2fsck 1.45.5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;07-Jan-2020&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
data: recovering journal
JBD2: Invalid checksum recovering block 185073680 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;log
JBD2: Invalid checksum recovering block 89 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;log
Journal checksum error found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;data
data was not cleanly unmounted, check forced.
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
Free blocks count wrong &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;704006059, &lt;span class=&quot;nv&quot;&gt;counted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;696320594&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Fix? &lt;span class=&quot;nb&quot;&gt;yes
&lt;/span&gt;Free inodes count wrong &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;182701042, &lt;span class=&quot;nv&quot;&gt;counted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;182694547&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Fix? &lt;span class=&quot;nb&quot;&gt;yes
 &lt;/span&gt;data: FILE SYSTEM WAS MODIFIED
data: 429421/183123968 files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2% non-contiguous&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 36152110/732472704 blocks
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can use this same steps (or similar) to remove /dev/sdc and replace with a brand new hard drive. In my case wiggling solved the problem for now. (I probably will need a drive in the near future)&lt;/p&gt;

&lt;p&gt;I hope this helped someone. It surely will help me when I will have to do this again üòõ&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="General" /><category term="linux" /><category term="tips" /><summary type="html">It happens, you just lost a disk on your RAID5 MD array, or things are not how it should look like‚Ä¶ How do we troubleshoot this?</summary></entry><entry><title type="html">Run pihole without raspberry pi</title><link href="http://localhost:4000/general/run-pihole-without-raspberry-pi/" rel="alternate" type="text/html" title="Run pihole without raspberry pi" /><published>2019-11-16T10:38:02-08:00</published><updated>2019-11-16T10:38:02-08:00</updated><id>http://localhost:4000/general/run-pihole-without-raspberry-pi</id><content type="html" xml:base="http://localhost:4000/general/run-pihole-without-raspberry-pi/">&lt;p&gt;I have few 24/7 running linux boxes at home. I wanted to try &lt;a href=&quot;https://pi-hole.net&quot;&gt;pi-hole&lt;/a&gt;. But I really didn‚Äôt want to add another computer (raspberry pi) on my network.&lt;/p&gt;

&lt;p&gt;So my initial feeling was why not try Docker? Good choice. Here is how easy it was.&lt;/p&gt;

&lt;p&gt;Pull pihole docker image&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker pull pihole/pihole
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Find your local IP (Replace eth0 with your ethernet identifier)&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ip addr show eth0 | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;inet&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 1
192.168.0.100
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Get the IP (192.168.0.100 in my case) and run docker:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; pihole &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ServerIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.0.100 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;WEBPASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;myawesomepassword&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DNS1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8.8.8.8 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 9080:80 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 53:53/tcp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 53:53/udp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 9443:443 pihole/pihole:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here in this example above I‚Äôm using myawesomepassword as login password to pihole (Change it to your password). I connect the host OS port 9080 to pihole‚Äôs port 80 and 9443 to pihole‚Äôs port 443.&lt;/p&gt;

&lt;p&gt;DNS server is running on port 53. (Since I‚Äôm not doing any zone transfer I can leave TCP 53 out, but oh well ¬Ø\_(„ÉÑ)_/¬Ø )&lt;/p&gt;

&lt;p&gt;You can login to the admin interface in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://192.168.100:9080/admin&lt;/code&gt; and start setting your pihole up.&lt;/p&gt;

&lt;p&gt;Have fun blocking pesky DNS requests ;)&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="dns" /><category term="docker" /><category term="linux" /><category term="pihole" /><summary type="html">I have few 24/7 running linux boxes at home. I wanted to try pi-hole. But I really didn‚Äôt want to add another computer (raspberry pi) on my network.</summary></entry><entry><title type="html">shadowsocks auto deploy</title><link href="http://localhost:4000/general/security/shadowsocks-auto-deploy/" rel="alternate" type="text/html" title="shadowsocks auto deploy" /><published>2018-04-06T09:37:58-07:00</published><updated>2018-04-06T09:37:58-07:00</updated><id>http://localhost:4000/general/security/shadowsocks-auto-deploy</id><content type="html" xml:base="http://localhost:4000/general/security/shadowsocks-auto-deploy/">&lt;p&gt;I wrote a &lt;a href=&quot;http://cloudinit.readthedocs.io/en/latest/index.html&quot;&gt;cloud-init&lt;/a&gt; script to automate the deployment of a &lt;a href=&quot;https://en.wikipedia.org/wiki/Shadowsocks&quot;&gt;shadowsocks server&lt;/a&gt;. I shared it &lt;a href=&quot;https://gist.github.com/emresaglam/e1e442791cd5b3841b3159c0b9f071e4&quot;&gt;in a gist here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Features:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Creates a non-privileged user
&lt;ul&gt;
&lt;li&gt;Uploads your ssh public key to the user&lt;/li&gt;
&lt;li&gt;Adds this user to the sudoers group&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Disables ssh login for the root user&lt;/li&gt;
&lt;li&gt;Downloads and installs libraries required for &lt;a href=&quot;https://en.wikipedia.org/wiki/Salsa20#ChaCha20_adoption&quot;&gt;chacha20&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Creates a &quot;random&quot; password and writes it in the config.json file&lt;/li&gt;
&lt;li&gt;config.json file is in the /root directory. (You will need the password in this config file to be able to connect to your shadowsocks server.)&lt;/li&gt;
&lt;li&gt;Starts the shadowsocks server.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You have to fill out the _YOURUSERNAMEHERE_, _YOURSSHPUBLICKEYHERE_ and _YOURFULLNAMEHERE_ with your data.&lt;/p&gt;
&lt;p&gt;You can use this script in DigitalOcean easily following&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-use-cloud-config-for-your-initial-server-setup&quot;&gt; this document&lt;/a&gt;.&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="security" /><category term="linux" /><category term="security" /><summary type="html">I wrote a cloud-init script to automate the deployment of a shadowsocks server. I shared it in a gist here. Features: Creates a non-privileged user Uploads your ssh public key to the user Adds this user to the sudoers group Disables ssh login for the root user Downloads and installs libraries required for chacha20 Creates a &quot;random&quot; password and writes it in the config.json file config.json file is in the /root directory. (You will need the password in this config file to be able to connect to your shadowsocks server.) Starts the shadowsocks server. You have to fill out the _YOURUSERNAMEHERE_, _YOURSSHPUBLICKEYHERE_ and _YOURFULLNAMEHERE_ with your data. You can use this script in DigitalOcean easily following this document.</summary></entry><entry><title type="html">Air Quality Index Bot</title><link href="http://localhost:4000/general/air_quality_index_bot/" rel="alternate" type="text/html" title="Air Quality Index Bot" /><published>2017-10-16T21:09:45-07:00</published><updated>2017-10-16T21:09:45-07:00</updated><id>http://localhost:4000/general/air_quality_index_bot</id><content type="html" xml:base="http://localhost:4000/general/air_quality_index_bot/">&lt;p&gt;After the devastating Northern California wildfires, I found myself looking at &lt;a href=&quot;http://airnow.gov/&quot; title=&quot;Airnow&quot;&gt;AirNow&lt;/a&gt;¬†multiple times a day. Also at work, like many Bay Area tech companies, we use HipChat (or Slack). Naturally I was inclined to issue a slash command to get the latest air quality index (AQI) for my area in a chat channel. I couldn‚Äôt find a good AQI bot so I wrote one.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-10-16-at-9.19.51-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-10-16-at-9.19.51-PM.png&quot; alt=&quot;Example bot blabber&quot; title=&quot;Bot blabber&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Installation for Heroku is on the README of the project. How to add a slash command for HipChat and/or Slack are not covered in this blog entry, but it‚Äôs very easy :) (I used /aq &amp;lt;zipcode&amp;gt; for command)&lt;/p&gt;

&lt;p&gt;The bot (really an API endpoint) &lt;a href=&quot;https://github.com/emresaglam/airbot&quot;&gt;is here in my github repo&lt;/a&gt;. Feel free to use, improve, contribute to it.&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="api" /><category term="git" /><category term="github" /><category term="opensource" /><category term="project" /><summary type="html">After the devastating Northern California wildfires, I found myself looking at AirNow¬†multiple times a day. Also at work, like many Bay Area tech companies, we use HipChat (or Slack). Naturally I was inclined to issue a slash command to get the latest air quality index (AQI) for my area in a chat channel. I couldn‚Äôt find a good AQI bot so I wrote one.</summary></entry><entry><title type="html">iCloud Photos, Meraki and Traffic Shaping</title><link href="http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping/" rel="alternate" type="text/html" title="iCloud Photos, Meraki and Traffic Shaping" /><published>2017-09-25T19:25:42-07:00</published><updated>2017-09-25T19:25:42-07:00</updated><id>http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping</id><content type="html" xml:base="http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping/">&lt;p&gt;I turned &lt;a href=&quot;https://www.apple.com/icloud/photos/&quot;&gt;iCloud Photo Library&lt;/a&gt; on this week. We have close to 250 GB of photos, videos in several different computers and mobile devices. You might have guessed it: it flooded our network since our outbound internet peaks around 6 Mbs (realistically). I needed to do something.&lt;/p&gt;
&lt;p&gt;I have at home a &lt;a href=&quot;https://meraki.cisco.com/products/appliances/mx65&quot;&gt;Meraki MX65&lt;/a&gt; and a &lt;a href=&quot;https://meraki.cisco.com/products/wireless/mr42&quot;&gt;MR42&lt;/a&gt;¬†(Thanks Daƒühan ;) ) They give great visibility and control over our home network. I can easily pinpoint where the problem is and take actions. Here is a great chart that shows how the nature of our traffic changed on Sep 24 after turning iCloud Photo Library on. (See the light blue? That's increased upload!)&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.39.41-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.39.41-PM.png&quot; alt=&quot;&quot; width=&quot;501&quot; height=&quot;204&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;One of the easiest way to slow this traffic down¬†is to shape it with Meraki Traffic Shaping rules. &lt;a href=&quot;https://documentation.meraki.com/MX-Z/Firewall_and_Traffic_Shaping/Traffic_Shaping_Settings&quot;&gt;This document&lt;/a&gt; talks about in detail how to do this. However the iCloud settings in the canned traffic shaping rules is only related to backup and doesn't work with iCloud Photo Library traffic.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.55.37-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.55.37-PM.png&quot; alt=&quot;&quot; width=&quot;460&quot; height=&quot;460&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Meraki allows you to do application layer or layer 3 traffic shaping. Since the traffic is encrypted, the application layer traffic shaping was not an option. For layer 3, I needed the IPs that the Photos app was talking to. Since Apple owns the entire 17.0.0.0/8, it's always an option to craft your rule using the entire &lt;a href=&quot;https://en.wikipedia.org/wiki/Classful_network#Classful_addressing_definition&quot;&gt;class A subnet&lt;/a&gt;. However that wouldn't be &quot;elegant&quot; :) So let's do some tcpdump exercise.&lt;/p&gt;
&lt;pre&gt;iMac:~ user$ sudo tcpdump -i en1 -n -c 1000 ip and net 17.0.0.0/8 | grep '&amp;gt;'| cut -d '&amp;gt;' -f 2 | cut -d &quot;.&quot; -f 1-4 | grep 17\. | sort | uniq -c &lt;/pre&gt;
&lt;pre&gt;tcpdump: verbose output suppressed, use -v or -vv for full protocol decode&lt;/pre&gt;
&lt;pre&gt;listening on en1, link-type EN10MB (Ethernet), capture size 262144 bytes&lt;/pre&gt;
&lt;pre&gt;1000 packets captured&lt;/pre&gt;
&lt;pre&gt;2120 packets received by filter&lt;/pre&gt;
&lt;pre&gt;0 packets dropped by kernel&lt;/pre&gt;
&lt;pre&gt; 647  17.248.128.44&lt;/pre&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;p&gt;What this tells us is that we captured 1000 packets and looked for all the ones that has &quot;17.&quot; in it, and counted them. In total 647 packets were transmitted to 17.248.128.44. Also it's on port 443 only.&lt;/p&gt;
&lt;p&gt;I did a similar packet dump for 10K packets. Which revealed that the sync between Photos app and iCloud is always happening on subnets: 17.248.0.0/16 and 17.188.0.0/16 on port 443. (There might be a more specific subnet, but this was enough for me to start with)&lt;/p&gt;
&lt;p&gt;Let's apply this to Meraki MX65 traffic shaping rules. In this rule below my upload limit per client is 1.5 Mbps. Depending on how many clients you have and your upload speed, you can come up with something more suitable for your network.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-7.19.52-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-7.19.52-PM.png&quot; alt=&quot;&quot; width=&quot;1256&quot; height=&quot;632&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In order to figure out how to define these in Meraki, please&lt;a href=&quot;https://documentation.meraki.com/MX-Z/Firewall_and_Traffic_Shaping/Traffic_Shaping_Settings&quot;&gt; follow the instructions&lt;/a&gt; in the previous doc that I linked.&lt;/p&gt;
&lt;p&gt;Et Voil√†! You got your home network back ;)&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="apple" /><category term="icloud" /><category term="network" /><category term="tips" /><summary type="html">I turned iCloud Photo Library on this week. We have close to 250 GB of photos, videos in several different computers and mobile devices. You might have guessed it: it flooded our network since our outbound internet peaks around 6 Mbs (realistically). I needed to do something. I have at home a Meraki MX65 and a MR42¬†(Thanks Daƒühan ;) ) They give great visibility and control over our home network. I can easily pinpoint where the problem is and take actions. Here is a great chart that shows how the nature of our traffic changed on Sep 24 after turning iCloud Photo Library on. (See the light blue? That's increased upload!) One of the easiest way to slow this traffic down¬†is to shape it with Meraki Traffic Shaping rules. This document talks about in detail how to do this. However the iCloud settings in the canned traffic shaping rules is only related to backup and doesn't work with iCloud Photo Library traffic. Meraki allows you to do application layer or layer 3 traffic shaping. Since the traffic is encrypted, the application layer traffic shaping was not an option. For layer 3, I needed the IPs that the Photos app was talking to. Since Apple owns the entire 17.0.0.0/8, it's always an option to craft your rule using the entire class A subnet. However that wouldn't be &quot;elegant&quot; :) So let's do some tcpdump exercise. iMac:~ user$ sudo tcpdump -i en1 -n -c 1000 ip and net 17.0.0.0/8 | grep '&amp;gt;'| cut -d '&amp;gt;' -f 2 | cut -d &quot;.&quot; -f 1-4 | grep 17\. | sort | uniq -c tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on en1, link-type EN10MB (Ethernet), capture size 262144 bytes 1000 packets captured 2120 packets received by filter 0 packets dropped by kernel 647 17.248.128.44 What this tells us is that we captured 1000 packets and looked for all the ones that has &quot;17.&quot; in it, and counted them. In total 647 packets were transmitted to 17.248.128.44. Also it's on port 443 only. I did a similar packet dump for 10K packets. Which revealed that the sync between Photos app and iCloud is always happening on subnets: 17.248.0.0/16 and 17.188.0.0/16 on port 443. (There might be a more specific subnet, but this was enough for me to start with) Let's apply this to Meraki MX65 traffic shaping rules. In this rule below my upload limit per client is 1.5 Mbps. Depending on how many clients you have and your upload speed, you can come up with something more suitable for your network. In order to figure out how to define these in Meraki, please follow the instructions in the previous doc that I linked. Et Voil√†! You got your home network back ;)</summary></entry><entry><title type="html">iCloud Photos, Meraki and Traffic Shaping MD</title><link href="http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping/" rel="alternate" type="text/html" title="iCloud Photos, Meraki and Traffic Shaping MD" /><published>2017-09-25T19:25:42-07:00</published><updated>2017-09-25T19:25:42-07:00</updated><id>http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping</id><content type="html" xml:base="http://localhost:4000/general/icloud-photos-meraki-and-traffic-shaping/">&lt;p&gt;I turned &lt;a href=&quot;https://www.apple.com/icloud/photos/&quot;&gt;iCloud Photo Library&lt;/a&gt; on this week. We have close to 250 GB of photos, videos in several different computers and mobile devices. You might have guessed it: it flooded our network since our outbound internet peaks around 6 Mbs (realistically). I needed to do something.&lt;/p&gt;

&lt;p&gt;I have at home a &lt;a href=&quot;https://meraki.cisco.com/products/appliances/mx65&quot;&gt;Meraki MX65&lt;/a&gt; and a &lt;a href=&quot;https://meraki.cisco.com/products/wireless/mr42&quot;&gt;MR42&lt;/a&gt; (Thanks Daƒühan ;) ) They give great visibility and control over our home network. I can easily pinpoint where the problem is and take actions. Here is a great chart that shows how the nature of our traffic changed on Sep 24 after turning iCloud Photo Library on. (See the light blue? That‚Äôs increased upload!)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.39.41-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.39.41-PM.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;One of the easiest way to slow this traffic down is to shape it with Meraki Traffic Shaping rules. &lt;a href=&quot;https://documentation.meraki.com/MX-Z/Firewall_and_Traffic_Shaping/Traffic_Shaping_Settings&quot;&gt;This document&lt;/a&gt; talks about in detail how to do this. However the iCloud settings in the canned traffic shaping rules is only related to backup and doesn‚Äôt work with iCloud Photo Library traffic.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.55.37-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-4.55.37-PM.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Meraki allows you to do application layer or layer 3 traffic shaping. Since the traffic is encrypted, the application layer traffic shaping was not an option. For layer 3, I needed the IPs that the Photos app was talking to. Since Apple owns the entire 17.0.0.0/8, it‚Äôs always an option to craft your rule using the entire &lt;a href=&quot;https://en.wikipedia.org/wiki/Classful_network#Classful_addressing_definition&quot;&gt;class A subnet&lt;/a&gt;. However that wouldn‚Äôt be ‚Äúelegant‚Äù :) So let‚Äôs do some tcpdump exercise.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;iMac:~ user&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; en1 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 1000 ip and net 17.0.0.0/8 | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&amp;gt;'&lt;/span&gt;| &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&amp;gt;'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 2 | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 1-4 | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;17&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 
tcpdump: verbose output suppressed, use &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; or &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;full protocol decode
listening on en1, link-type EN10MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, capture size 262144 bytes
1000 packets captured
2120 packets received by filter
0 packets dropped by kernel
  647  17.248.128.44
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What this tells us is that we captured 1000 packets and looked for all the ones that has ‚Äú17.‚Äù in it, and counted them. In total 647 packets were transmitted to 17.248.128.44. Also it‚Äôs on port 443 only.&lt;/p&gt;

&lt;p&gt;I did a similar packet dump for 10K packets. Which revealed that the sync between Photos app and iCloud is always happening on subnets: 17.248.0.0/16 and 17.188.0.0/16 on port 443. (There might be a more specific subnet, but this was enough for me to start with)&lt;/p&gt;

&lt;p&gt;Let‚Äôs apply this to Meraki MX65 traffic shaping rules. In this rule below my upload limit per client is 1.5 Mbps. Depending on how many clients you have and your upload speed, you can come up with something more suitable for your network.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/Screen-Shot-2017-09-25-at-7.19.52-PM.png&quot;&gt;&lt;img src=&quot;/assets/img/Screen-Shot-2017-09-25-at-7.19.52-PM.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In order to figure out how to define these in Meraki, please &lt;a href=&quot;https://documentation.meraki.com/MX-Z/Firewall_and_Traffic_Shaping/Traffic_Shaping_Settings&quot;&gt;follow the instructions&lt;/a&gt; in the previous doc that I linked.&lt;/p&gt;

&lt;p&gt;Et Voil√†! You got your home network back ;)&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="general" /><category term="apple" /><category term="icloud" /><category term="network" /><category term="tips" /><summary type="html">I turned iCloud Photo Library on this week. We have close to 250 GB of photos, videos in several different computers and mobile devices. You might have guessed it: it flooded our network since our outbound internet peaks around 6 Mbs (realistically). I needed to do something.</summary></entry><entry><title type="html">Yaesu FTM-400XDR and Chirp</title><link href="http://localhost:4000/general/yaesu-ftm-400xdr-and-chirp/" rel="alternate" type="text/html" title="Yaesu FTM-400XDR and Chirp" /><published>2016-12-18T14:10:02-08:00</published><updated>2016-12-18T14:10:02-08:00</updated><id>http://localhost:4000/general/yaesu-ftm-400xdr-and-chirp</id><content type="html" xml:base="http://localhost:4000/general/yaesu-ftm-400xdr-and-chirp/">&lt;p&gt;I use &lt;a href=&quot;http://chirp.danplanet.com/projects/chirp/wiki/Home&quot;&gt;Chirp.&lt;/a&gt; I love it. It's the only way to program my Baofeng UV-R(+) radios... Period.&lt;/p&gt;
&lt;p&gt;Also I love that I can download repeater settings according to a zip code, county, state, etc...&lt;/p&gt;
&lt;p&gt;I wanted to use Chirp for my &lt;a href=&quot;http://www.yaesu.com/indexVS.cfm?cmd=DisplayProducts&amp;amp;ProdCatID=249&amp;amp;encProdID=227201D29C822AEFF8482F3367495319&quot;&gt;Yaesu FTM-400XDR&lt;/a&gt;. However it looks like Chirp doesn't support this model. So my initial reaction was to create the repeater list with Chirp, export on CSV, and import it to Yaesu.&lt;/p&gt;
&lt;p&gt;But, that wasn't possible either since Yaesu expects the data in a different order and format.&lt;/p&gt;
&lt;p&gt;I wrote a &lt;a href=&quot;https://github.com/emresaglam/chirp2yaesu&quot;&gt;small python script&lt;/a&gt; that rearranges and reformats the CSV file to the expected import file for the &lt;a href=&quot;http://www.yaesu.com/indexVS.cfm?cmd=DisplayProducts&amp;amp;ProdCatID=249&amp;amp;encProdID=227201D29C822AEFF8482F3367495319&quot;&gt;Yaesu's own software&lt;/a&gt;. Check out¬†the &lt;a href=&quot;https://github.com/emresaglam/chirp2yaesu/blob/master/README.md&quot;&gt;README&lt;/a&gt; to read how you can install and use the script.&lt;/p&gt;
&lt;p&gt;By the way, Yaesu's software to program the radio doesn't work on Mac OS X natively, since it's a Windows software. I managed to run it on Mac OS X using &lt;a href=&quot;https://www.winehq.org/&quot;&gt;wine&lt;/a&gt;. But that's another blog entry...&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="General" /><category term="ftm400" /><category term="ftm400xdr" /><category term="git" /><category term="github" /><category term="ham radio" /><category term="python" /><category term="tips" /><category term="tricks" /><category term="yaesu" /><summary type="html">I use Chirp. I love it. It's the only way to program my Baofeng UV-R(+) radios... Period. Also I love that I can download repeater settings according to a zip code, county, state, etc... I wanted to use Chirp for my Yaesu FTM-400XDR. However it looks like Chirp doesn't support this model. So my initial reaction was to create the repeater list with Chirp, export on CSV, and import it to Yaesu. But, that wasn't possible either since Yaesu expects the data in a different order and format. I wrote a small python script that rearranges and reformats the CSV file to the expected import file for the Yaesu's own software. Check out¬†the README to read how you can install and use the script. By the way, Yaesu's software to program the radio doesn't work on Mac OS X natively, since it's a Windows software. I managed to run it on Mac OS X using wine. But that's another blog entry...</summary></entry><entry><title type="html">No timer in Mac OS X? No problem!</title><link href="http://localhost:4000/general/no-timer-in-mac-os-x-no-problem/" rel="alternate" type="text/html" title="No timer in Mac OS X? No problem!" /><published>2016-10-11T20:20:46-07:00</published><updated>2016-10-11T20:20:46-07:00</updated><id>http://localhost:4000/general/no-timer-in-mac-os-x-no-problem</id><content type="html" xml:base="http://localhost:4000/general/no-timer-in-mac-os-x-no-problem/">&lt;p&gt;Mac OS X doesn't come with a timer installed by default. There are bunch of timers in the App Store, you can definitely install one of those.&lt;/p&gt;
&lt;p&gt;But here is how to make one from scratch.¬†Open terminal screen and type:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sleep 5 ; say &quot;Time is up&quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Well that's it :) This command will sleep for 5 seconds and say &quot;Time is up&quot; at the end of 5 seconds.&lt;/p&gt;
&lt;p&gt;We can make a little script out of it¬†and save as¬†/usr/local/bin/timer as¬†below:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;#!/bin/bash&lt;br /&gt;
sleep $1 ; say &quot;Time is up&quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can invoke the command like this, it¬†will sleep 5 seconds and tell you &quot;Time is up&quot;:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;timer 5&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;As a bonus, if you want minutes instead of seconds, you can always do something like this which will run the timer for 5 minutes:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;timer `echo &quot;5*60&quot; | bc`&lt;/code&gt;&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="General" /><category term="command line" /><category term="mac" /><category term="mac OS X" /><category term="terminal" /><category term="tips" /><summary type="html">Mac OS X doesn't come with a timer installed by default. There are bunch of timers in the App Store, you can definitely install one of those. But here is how to make one from scratch.¬†Open terminal screen and type: sleep 5 ; say &quot;Time is up&quot; Well that's it :) This command will sleep for 5 seconds and say &quot;Time is up&quot; at the end of 5 seconds. We can make a little script out of it¬†and save as¬†/usr/local/bin/timer as¬†below: #!/bin/bash sleep $1 ; say &quot;Time is up&quot; You can invoke the command like this, it¬†will sleep 5 seconds and tell you &quot;Time is up&quot;: timer 5 As a bonus, if you want minutes instead of seconds, you can always do something like this which will run the timer for 5 minutes: timer `echo &quot;5*60&quot; | bc`</summary></entry><entry><title type="html">Bloomsky weather data in pymultimonaprs</title><link href="http://localhost:4000/general/bloomsky-weather-data-in-pymultimonaprs/" rel="alternate" type="text/html" title="Bloomsky weather data in pymultimonaprs" /><published>2016-10-08T11:44:59-07:00</published><updated>2016-10-08T11:44:59-07:00</updated><id>http://localhost:4000/general/bloomsky-weather-data-in-pymultimonaprs</id><content type="html" xml:base="http://localhost:4000/general/bloomsky-weather-data-in-pymultimonaprs/">&lt;p&gt;I wrote a small python script to get the&lt;a href=&quot;http://bloomsky.com&quot;&gt; BloomSky&lt;/a&gt; weather data and &quot;air&quot;¬†it on &lt;a href=&quot;https://en.wikipedia.org/wiki/Automatic_Packet_Reporting_System&quot;&gt;APRS&lt;/a&gt; using &lt;a href=&quot;https://github.com/asdil12/pymultimonaprs&quot;&gt;pymultimonaprs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can find it in my &lt;a href=&quot;https://github.com/emresaglam/bloomsky-to-aprs&quot;&gt;github repo&lt;/a&gt;. Read the &lt;a href=&quot;https://github.com/emresaglam/bloomsky-to-aprs/blob/master/README.md&quot;&gt;README.md&lt;/a&gt; file on how to set it up.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</content><author><name>Emre Saƒülam</name></author><category term="General" /><category term="aprs" /><category term="bloomsky" /><category term="code" /><category term="opensource" /><category term="weather" /><summary type="html">I wrote a small python script to get the BloomSky weather data and &quot;air&quot;¬†it on APRS using pymultimonaprs. You can find it in my github repo. Read the README.md file on how to set it up. &amp;nbsp;</summary></entry></feed>